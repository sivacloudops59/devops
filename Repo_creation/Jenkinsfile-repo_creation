pipeline {
    agent any

    parameters {
        string(name: 'REPO_NAME', defaultValue: '', description: 'GitHub repository name')
        string(name: 'BRANCH_NAME', defaultValue: '', description: 'Branch to create')
    }

    environment {
        GITHUB_TOKEN = credentials('github_token')       // Jenkins credential ID
        GITHUB_USERNAME = 'sivacloudops59'            // hardcoded or env var
        GITHUB_PWD=  'M#essileo78'
    }

    stages {
        stage('setup python environment'){
            script{
                sh '''
                    python3 -m venv venv
                    . venv/bin/activate
                    pip install requests
                '''
            }
        }
        stage('Create Repository') {
            steps{
                script{

                    def outputlog = sh(script:" python Repo_creation/create_repo.py ${GITHUB_PWD} ${repo_name}", returnStdout:true).trim()
                  echo "${outputlog}"
                }
            }
        }
        stage('create Branch'){
            steps{
                script{
                    def outputlog= sh(script:" python Repo_creation/create_branch.py ${GITHUB_PWD} ${repo_name}", returnStdout:true).trim()
                    echo "${outputlog}"
                }
            }

        }
    }
}
